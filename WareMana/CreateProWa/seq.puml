
@startuml
autonumber
actor "User" as User
participant "UI Service" as UI
participant ":ProductController" as Ctrl
participant ":ServiceProduct" as Svc
participant ":IRepositoryProduct" as Repo
database "DB" as DB

User -> UI : Nhấn nút "Tạo mới Sản phẩm"
UI --> User : Hiển thị form tạo mới

User -> UI : Điền thông tin và nhấn "Lưu"
UI -> Ctrl : CreateProduct(model)
activate Ctrl

alt Dữ liệu không hợp lệ (!ModelState.IsValid)
autonumber 5.1
    Ctrl --> UI : BadRequest(ApiResponse.Fail)
    UI --> User : Hiển thị thông báo lỗi
else Dữ liệu hợp lệ
autonumber 5
    Ctrl -> Ctrl : Map ProductCreateVM to Product entity
    
    Ctrl -> Svc : CreateAsync(entity)
    activate Svc
    
    Svc -> Repo : Add(entity)
    activate Repo
    Repo --> Svc : entity
    deactivate Repo
    
    Svc -> Repo : SaveAsync()
    activate Repo
    Repo -> DB : INSERT INTO Products...
    activate DB
    DB --> Repo : Success
    deactivate DB
    Repo --> Svc : Task Completed
    deactivate Repo
    
    Svc --> Ctrl : Task Completed
    deactivate Svc
    
    Ctrl --> UI : Ok(ApiResponse.Ok)
    deactivate Ctrl
    
    UI --> User : Hiển thị thông báo "Tạo thành công"
end