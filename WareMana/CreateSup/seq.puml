@startuml
title Sequence Diagram - Create Supplier (Happy Path)
autonumber

actor "Admin/Manager" as User
participant "UI Service" as UI
participant "SupplierController" as Ctrl
participant "SupplierService" as Svc
participant "SupplierRepository" as Repo
database "Database" as DB

User -> UI : Nhập thông tin nhà cung cấp và nhấn "Lưu"
UI -> Ctrl : POST /api/suppliers/CreateSupplier\n(SupplierCreateVM)
activate Ctrl

Ctrl -> Svc : GetByEmail(model.Email)
activate Svc
Svc -> DB : Query Supplier by Email
activate DB
DB --> Svc : null (Not Found)
deactivate DB
Svc --> Ctrl : null
deactivate Svc

Ctrl -> Svc : GetByPhone(model.Phone)
activate Svc
Svc -> DB : Query Supplier by Phone
activate DB
DB --> Svc : null (Not Found)
deactivate DB
Svc --> Ctrl : null
deactivate Svc

Ctrl -> Ctrl : Map SupplierCreateVM to Supplier Entity
Ctrl -> Ctrl : Set IsActive = true, CreatedAt = Now

Ctrl -> Svc : CreateAsync(entity)
activate Svc
Svc -> Repo : Add(entity)
activate Repo
Repo --> Svc : entity
deactivate Repo

Svc -> Repo : SaveAsync()
activate Repo
Repo -> DB : Insert Supplier
activate DB
DB --> Repo : Success
deactivate DB
Repo --> Svc : Task Completed
deactivate Repo

Svc --> Ctrl : Task Completed
deactivate Svc

Ctrl --> UI : Ok(ApiResponse<Supplier>)
deactivate Ctrl

UI --> User : Hiển thị thông báo "Tạo nhà cung cấp thành công"

@enduml